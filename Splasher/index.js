(function(l,r,s,b,y){"use strict";var p=void 0;let a=[];const c=/\u{e0042}\u{e004E}\u{e0052}\u{e003C}([\u{e0061}-\u{e007A}\u{e0041}-\u{e005a}\u{e0030}-\u{e0039}]+?)\u{e003E}/u,P=function(o){const h=[...o].map(function(i){return i.codePointAt(0)}),d=[];for(const i of h)d.push(String.fromCodePoint(i+(0<i&&i<127?917504:0)).toString());return d.join("")};var B={onLoad:function(){let o;const h=r.findByName("ProfileBanner",!1),d=r.findByName("EditUserProfileBanner",!1),i=r.findByProps("getUserProfile"),g=r.findByProps("saveProfileChanges"),S=r.findByProps("setString"),v=r.findByName("ChangeBannerActionSheet",!1),C=r.findByProps("show","openLazy","close"),T=r.findByStoreName("UserStore");a.push(s.after("getUserProfile",i,function(e,n){if(n===void 0)return n;const t=n?.bio.match(c);return t&&(n.banner=t[0],n.bio=n.bio.replace(c,"")),n})),a.push(s.before("default",h,function(e){if(!e[0].bannerSource)return;const n=e[0].bannerSource.uri;if(!n)return;const t=n.match(c);if(t){const u=[...t[0]].map(function(f){return String.fromCodePoint(f.codePointAt(0)-917504)}).join("");e[0].bannerSource.uri=`https://i.imgur.com/${u.slice(4,-1)}.png`}})),a.push(s.instead("saveProfileChanges",g,function(e,n){const t=i.getUserProfile(T.getCurrentUser().id),u=e[0].bio!==void 0?e[0].bio:t.bio;if(e[0].banner===null)return e[0].bio=u,n.apply(p,e);if(!(e[0].banner||t.banner.match(c)))return n.apply(p,e);if(e[0].banner&&!o){y.showToast("Slow down and try again!",b.getAssetIDByName("ic_clock_timeout_16px"));return}const f=o?P(`BNR<${o}>`):t.banner,m=u+f;return m.length>190&&(S.setString(f),C.show({title:"Woah there!",body:`There's not enough space in your bio to insert your banner. You need to clear ${f.length} characters before you can continue. Your banner has been copied to the clipboard.`})),e[0].bio=m,o=null,n.apply(p,e)})),a.push(s.before("setPendingBanner",g,function(e){if(e[0]===null)return;const n=new FormData;n.append("image",e[0].split(",")[1]),fetch("https://api.imgur.com/3/image",{method:"POST",body:n,headers:{Authorization:"Client-ID 8218830746fcf7d"}}).then(function(t){t.json().then(function(u){y.showToast("Banner uploaded!",b.getAssetIDByName("ic_add_tier_40px")),o=u.data.id})})})),a.push(s.instead("default",d,function(e,n){const t=e[0].user.premiumType;e[0].user.premiumType=2;let u=n.apply(self,e);return e[0].user.premiumType=t,u})),a.push(s.before("default",v,function(e){e[0].isTryItOut=!0}))},onUnload:function(){for(const o of a)o()}};return l.default=B,Object.defineProperty(l,"__esModule",{value:!0}),l})({},vendetta.metro,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts);
