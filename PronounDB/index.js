(function(I,f,e,A,o,ae,c,w,g,re){"use strict";var T={Failed:c.getAssetIDByName("Small"),Delete:c.getAssetIDByName("ic_message_delete"),Copy:c.getAssetIDByName("toast_copy_link"),Open:c.getAssetIDByName("ic_leave_stage"),Clipboard:c.getAssetIDByName("pending-alert"),Clock:c.getAssetIDByName("clock"),Pronoun:c.getAssetIDByName("ic_accessibility_24px"),Settings:{Toasts:{Settings:c.getAssetIDByName("ic_selection_checked_24px"),Failed:c.getAssetIDByName("ic_close_circle_24px")},Initial:c.getAssetIDByName("coffee"),Update:c.getAssetIDByName("discover"),Locale:c.getAssetIDByName("ic_locale_24px"),External:c.getAssetIDByName("ic_raised_hand_list"),Edit:c.getAssetIDByName("ic_edit_24px")}},b={shadow:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.1;return{shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:n,shadowRadius:4.65,elevation:8}},displayToast:function(n,t){e.toasts.open({content:t=="clipboard"?`Copied ${n} to clipboard.`:n,source:t=="clipboard"?T.Clipboard:T.Settings.Initial})}};function k(n,t,r,i,s){try{return n(...t)}catch(a){console.warn(`[${r}] The following error happened when trying to ${i} ${s??"unspecificied label"}: ${a}`);return}}const V=function(n,t,r,i){return k(function(){if(n){n.length++,r++;for(let s=n.length-1;s>=r;s--)n[s]=n[s-1];return n[r-1]=t,n.length}},[n,t,r],o.manifest.name,"insert an item at",i)};var G={mapItem:function(n,t,r){return k(function(){let i=[];for(let s=0;s<n.length;s++)V(i,t(n[s],s,n),i.length);return i},[n,t],o.manifest.name,"map an array at",r)},insertItem:V},u={map:{},queue:[],fetching:!1,referenceMap:{hh:"he/him",hi:"he/it",hs:"he/she",ht:"he/they",ih:"it/him",ii:"it/its",is:"it/she",it:"it/they",shh:"she/he",sh:"she/her",si:"she/it",st:"she/they",th:"they/he",ti:"they/it",ts:"they/she",tt:"they/them",any:"any",other:"other",ask:"ask",avoid:"avoid, use name",unspecified:"unspecified"},async updateQueuedPronouns(){var n=this;if(this.queue.length<=0||this.fetching)return;const t=this.queue.splice(0,49),r=function(a){return n.queue.length<=0?a:n.map[a]?r(n.queue.shift()):a};for(const a of t)this.map[a]&&(t[a]=r(a));this.fetching=!0;const i=await(await fetch(`https://pronoundb.org/api/v1/lookup-bulk?platform=discord&ids=${t.join(",")}`,{method:"GET",headers:{Accept:"application/json","X-PronounDB-Source":"Vendetta"}})).json(),s=Object.fromEntries(Object.entries(i).filter(function(a){let[d,E]=a;return!isNaN(+d)}));Object.assign(this.map,s),this.fetching=!1,this.queue.length>0&&this.updateQueuedPronouns()}},x={plugin:{source:"https://github.com/acquitelol/vd-pronoun-db",pronoundb:"https://pronoundb.org/"},author:{profile:{"Rosie<3":"https://github.com/acquitelol"}}},B,_;const{View:Y,Text:H,TouchableOpacity:ie}=w.General,{useThemeContext:se}=f.findByProps("useThemeContext"),oe=((B=f.find(function(n){var t,r;return(r=n.default)===null||r===void 0||(t=r.internal)===null||t===void 0?void 0:t.resolveSemanticColor}))===null||B===void 0?void 0:B.default.internal.resolveSemanticColor)??((_=f.find(function(n){var t;return(t=n.meta)===null||t===void 0?void 0:t.resolveSemanticColor}))===null||_===void 0?void 0:_.meta.resolveSemanticColor)??function(){},le=f.findByName("UserProfileSection"),{UserProfileGradientCard:ce}=f.findByProps("UserProfileGradientCard"),q=f.findByProps("triggerHaptic"),C=e.stylesheet.createThemedStyleSheet({container:{alignSelf:"flex-start",padding:1,borderRadius:9,width:"100%",marginTop:-4,marginRight:-12},innerContainer:{paddingHorizontal:6,paddingVertical:8,overflow:"hidden",flexDirection:"row",justifyContent:"center",alignItems:"center"},circle:{width:10,height:10,borderRadius:10/2,marginRight:6},fallback:{color:g.semanticColors.BACKGROUND_SECONDARY_ALT},text:{fontFamily:e.constants.Fonts.DISPLAY_NORMAL}});function ue(n){let{pronoun:t}=n;const r=se(),i=oe(r.theme,g.semanticColors.TEXT_NORMAL);return e.React.createElement(le,{title:"Pronouns"},e.React.createElement(ie,{onPress:function(){e.toasts.open({content:t,source:T.Pronoun}),q&&q.triggerHaptic()},style:o.storage.isRole?{justifyContent:"center",alignItems:"center"}:{}},o.storage.isRole?e.React.createElement(ce,{style:C.container,fallbackBackground:C.fallback.color},e.React.createElement(Y,{style:C.innerContainer},e.React.createElement(Y,{style:[C.circle,{backgroundColor:i}]}),e.React.createElement(H,{style:[C.text,{color:i}]},t))):e.React.createElement(H,{style:[C.text,{fontSize:16,color:i}]},t)))}const{TouchableOpacity:N,View:$,Image:de,Text:O,Animated:P}=w.General,j=f.findByProps("transitionToGuild","openURL"),L=f.findByStoreName("UserStore"),he=f.findByProps("showUserProfile"),m=e.stylesheet.createThemedStyleSheet({container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",...b.shadow()},image:{width:75,height:75,borderRadius:10,...b.shadow()},mainText:{opacity:.975,letterSpacing:.25},header:{color:g.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:g.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function pe(n){let{name:t,authors:r}=n;var i,s;const a=e.React.useRef(new P.Value(1)).current,d=function(){return P.spring(a,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},E=function(){return P.spring(a,{toValue:1,duration:250,useNativeDriver:!0}).start()},v=function(){return he.showUserProfile({userId:L.getCurrentUser().id})},l={transform:[{scale:a}]};return e.React.createElement(e.React.Fragment,null,e.React.createElement($,{style:m.container},e.React.createElement(N,{onPress:v,onPressIn:d,onPressOut:E},e.React.createElement(P.View,{style:l},e.React.createElement(de,{style:[m.image],source:{uri:L==null||(s=L.getCurrentUser())===null||s===void 0||(i=s.getAvatarURL())===null||i===void 0?void 0:i.replace("webp","png")}}))),e.React.createElement($,{style:m.textContainer},e.React.createElement(N,{onPress:function(){return j.openURL(x.plugin.source)}},e.React.createElement(O,{style:[m.mainText,m.header]},t)),e.React.createElement($,{style:{flexDirection:"row"}},e.React.createElement(O,{style:[m.mainText,m.subHeader]},"A project by"),G.mapItem(r,function(h,p,D){return e.React.createElement(N,{onPress:function(){return j.openURL(x.author.profile[h.name]??"https://github.com/")}},e.React.createElement(O,{style:[m.mainText,m.subHeader,{paddingLeft:4,fontFamily:e.constants.Fonts.DISPLAY_BOLD,flexDirection:"row"}]},h.name,p<D.length-1?",":null))})))))}const{View:fe,Text:ge}=w.General,z=e.stylesheet.createThemedStyleSheet({text:{color:g.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:12}});function U(n){let{label:t,children:r}=n;return e.React.createElement(fe,{style:{marginTop:10}},e.React.createElement(ge,{style:[z.text,z.optionText]},t.toUpperCase()),r)}var M;const{Image:W}=w.General,ye=(M=e.ReactNative.Dimensions)===null||M===void 0?void 0:M.get("window").width;function K(n){let{style:t,source:r}=n;const[i,s]=e.React.useState({width:0,height:0}),[a,d]=e.React.useState(0),E=function(){const v=function(p){return typeof p=="string"?parseInt(p.replace("%",""))*ye/100:p},l=v(t.width);if(!t.maxWidth)return l;const h=v(t.maxWidth);return l>h?h:l};return e.React.useEffect(function(){W.getSize(r,function(v,l){s({width:v,height:l})},function(v){console.error(`[${o.manifest.name}] ${v} when fetching ${r}`)}),d(E())},[]),e.React.createElement(W,{style:[...Array.isArray(t)?t:[t],{height:a*(i.height/i.width)}],source:{uri:r},resizeMode:"stretch"})}const{FormRow:R,FormSwitch:Q,FormDivider:X}=w.Forms,{ScrollView:Re,View:S,Text:ve}=w.General,J=f.findByProps("transitionToGuild","openURL"),y=e.stylesheet.createThemedStyleSheet({icon:{color:g.semanticColors.INTERACTIVE_NORMAL},item:{color:g.semanticColors.TEXT_MUTED,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM},container:{width:"90%",marginLeft:"5%",borderRadius:10,backgroundColor:g.semanticColors.BACKGROUND_MOBILE_SECONDARY,...b.shadow()},subheaderText:{color:g.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:14},image:{width:"100%",maxWidth:350,borderRadius:10}});function me(){re.useProxy(o.storage);const[n,t]=e.React.useState(o.storage.isTimestamp),[r,i]=e.React.useState(o.storage.isRole);return e.React.createElement(Re,null,e.React.createElement(pe,{name:o.manifest.name,authors:o.manifest.authors}),e.React.createElement(S,{style:{marginTop:20}},e.React.createElement(U,{label:"Preferences"},e.React.createElement(S,{style:[y.container]},e.React.createElement(R,{label:"Timestamps",subLabel:"Use Timestamps instead of OP Tag for the pronoun in the chat area.",onLongPress:function(){return b.displayToast(`By default, ${o.manifest.name} will use the OP tag to display pronouns. Toggling this option will always use Timestamps instead of OP tag for pronouns.`,"tooltip")},leading:e.React.createElement(R.Icon,{style:y.icon,source:T.Settings.Locale}),trailing:e.React.createElement(Q,{value:o.storage.isTimestamp,onValueChange:function(){o.storage.isTimestamp=!o.storage.isTimestamp,t(o.storage.isTimestamp)}})}),e.React.createElement(X,null),e.React.createElement(R,{label:"Roles",subLabel:"Show the pronoun styled as a role instead of plain text inside of profiles.",onLongPress:function(){return b.displayToast(`With this option enabled, ${o.manifest.name} will style pronouns as roles in profiles. Otherwise, it will style them as plain text.`,"tooltip")},leading:e.React.createElement(R.Icon,{style:y.icon,source:T.Settings.Edit}),trailing:e.React.createElement(Q,{value:o.storage.isRole,onValueChange:function(){o.storage.isRole=!o.storage.isRole,i(o.storage.isRole)}})}))),e.React.createElement(U,{label:"Previews"},e.React.createElement(S,{style:{...y.container,maxWidth:350}},e.React.createElement(K,{style:y.image,source:`https://cdn.discordapp.com/attachments/${n?"1011346757214543875/1075007230337896448/pronoun-timestamp.png":"1011346757214543875/1075007230107193374/pronoun-tag.png"}`})),e.React.createElement(S,{style:{...y.container,marginTop:10,maxWidth:350}},e.React.createElement(K,{style:y.image,source:`https://cdn.discordapp.com/attachments/${r?"1011346757214543875/1075007778399199282/profile-role.png":"1011346757214543875/1075007778067841044/profile-plain.png"}`}))),e.React.createElement(U,{label:"Source"},e.React.createElement(S,{style:y.container},e.React.createElement(R,{label:"Source",subLabel:`Open the repository of ${o.manifest.name} externally.`,onLongPress:function(){return b.displayToast(`Opens the repository of ${o.manifest.name} on GitHub in an external page to view any source code of the plugin.`,"tooltip")},leading:e.React.createElement(R.Icon,{style:y.icon,source:T.Open}),trailing:function(){return e.React.createElement(R.Arrow,null)},onPress:function(){J.openURL(x.plugin.source)}}),e.React.createElement(X,null),e.React.createElement(R,{label:"PronounDB",subLabel:`Open the ${o.manifest.name} website externally at \`https://pronoundb.org\`.`,onLongPress:function(){return b.displayToast("Opens the PronounDB website in an external page which allows you to link your Discord account to PronounDB.","tooltip")},leading:e.React.createElement(R.Icon,{style:y.icon,source:T.Settings.External}),trailing:function(){return e.React.createElement(R.Arrow,null)},onPress:function(){J.openURL(x.plugin.pronoundb)}})))),e.React.createElement(ve,{style:y.subheaderText},`Build: (${o.manifest.hash.substring(0,8)})`))}const Ee=f.find(function(n){var t;return(n==null||(t=n.type)===null||t===void 0?void 0:t.name)=="UserProfile"}),Te=f.findByStoreName("UserStore"),{DCDChatManager:be}=e.ReactNative.NativeModules,Z=e.stylesheet.createThemedStyleSheet({opTagBackgroundColor:{color:g.semanticColors.HEADER_PRIMARY},opTagTextColor:{color:g.semanticColors.BACKGROUND_PRIMARY}});let ee,te,ne;var we={onLoad:function(){ee=A.before("getUser",Te,function(n){const t=n[0];u.map[t]||G.insertItem(u.queue,t,u.queue.length,"user id pronoun queue"),u.updateQueuedPronouns()}),te=A.after("type",Ee,function(n,t){var r,i,s,a;const d=(i=ae.findInReactTree(t,function(l){var h,p;return(l==null||(h=l.type)===null||h===void 0?void 0:h.displayName)==="View"&&(l==null||(p=l.props)===null||p===void 0?void 0:p.children.findIndex(function(D){var F;return(D==null||(F=D.type)===null||F===void 0?void 0:F.name)==="UserProfileBio"}))!==-1}))===null||i===void 0||(r=i.props)===null||r===void 0?void 0:r.children;if(!d)return t;const{userId:E}=(d==null||(a=d.find(function(l){var h,p;return typeof(l==null||(p=l.props)===null||p===void 0||(h=p.displayProfile)===null||h===void 0?void 0:h.userId)=="string"}))===null||a===void 0||(s=a.props)===null||s===void 0?void 0:s.displayProfile)??{};if(!E||!u.map[E]||u.referenceMap[u.map[E]]==="unspecified")return t;const v=u.referenceMap[u.map[E]];d.unshift(React.createElement(ue,{pronoun:v}))}),ne=A.before("updateRows",be,function(n){const t=JSON.parse(n[1]);for(const a of t){var r,i,s;if(a.type!==1||!(!(a==null||(r=a.message)===null||r===void 0)&&r.authorId)||!u.map[a==null||(i=a.message)===null||i===void 0?void 0:i.authorId]||u.referenceMap[u.map[a==null||(s=a.message)===null||s===void 0?void 0:s.authorId]]==="unspecified")continue;const d=u.referenceMap[u.map[a.message.authorId]];if(o.storage.isTimestamp&&a.message.timestamp){a.message.timestamp+=" \u2022 "+d;continue}a.message.opTagText&&(a.message.tagText=a.message.tagText?a.message.tagText+" \u2022 ":""+a.message.opTagText),a.message.opTagText=d,a.message.opTagTextColor=e.ReactNative.processColor(Z.opTagTextColor.color),a.message.opTagBackgroundColor=e.ReactNative.processColor(Z.opTagBackgroundColor.color)}n[1]=JSON.stringify(t)})},onUnload:function(){ee?.(),te?.(),ne?.()},settings:me};return I.default=we,Object.defineProperty(I,"__esModule",{value:!0}),I})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.utils,vendetta.ui.assets,vendetta.ui.components,vendetta.ui,vendetta.storage);
